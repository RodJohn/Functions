
# 用户状态

## 作用

    1.提示共同会话人
    2.决定群消息是否转发
    
## 影响状态的因素    
  
### uc-token
  
    1.用户登陆时,uc服务端返回token
    2.用户发送请求时,如果临近token过期时间,则uc服务端在返回响应的同时返回新token    
    3.token超时,将用户状态设置为offline    
    4.用户发送请求时,如果超过token过期时间,则服务端返回token超时响应,要求客户端重新登录

### im-token

###  websocket
      
    1.页面刷新时,websocket断线并重连
      
      
## 状态标识更改不及时的可能造成的影响
      
    1.通过用户状态进行转发    丢消息   
    2.
      
## websocket保活


# 消息状态


      发送  数据入库
      送达  管道推送后的响应
      已读  客户端发送已读状态

apigateway 推送重试  返回推送结果


客户端缓存


       

    
    websocket
    http


实时

不丢不重


    
消息指针
    
    用户在线的会 会 频繁更新          

多端



离线消息
未读消息 

    优先级高
    数据量



用户数据/会话数据修改 推送

