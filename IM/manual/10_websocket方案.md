自己


stomp仿照大部分mq规则，分为topic和queue，topic为广播，queue为单播队列，这好理解。但是到了rabbitmq stomp插件这里是什么呢？——对每个用户无论topic还是queue的订阅都设置为queue，这不是rabbitmq的问题，而是spring的问题，spring为每个登陆用户分配一个session，即使同一用户登陆多个session，那么对同一个send to user的queue或者对同一个topic都会为这个订阅单独申请一个rabbitmq里的queue，对于erlang实现的高并发的rabbitmq来说这样实现简单想似乎并无问题，但是问题是每一个rabbitmq里的queue都会占用你内存，一个14k，当大量用户同时登陆的时候你可以想象……没错！内存会爆炸，而实际这些queue都是几乎没有繁忙工作的空队列，虽然订阅了，但是触发时机非常有限，大部分时间都是空的

所以解决方案是什么呢？那就是抛弃stomp提供的便利，自己在应用中实现这种多个用户多个session，同一个session多个订阅的模型



方案设计